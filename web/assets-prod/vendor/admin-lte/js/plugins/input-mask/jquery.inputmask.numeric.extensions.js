/*
Input Mask plugin extensions
http://github.com/RobinHerbots/jquery.inputmask
Copyright (c) 2010 - 2014 Robin Herbots
Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
Version: 0.0.0

Optional extensions on the jquery.inputmask base
*/

(function(e){e.extend(e.inputmask.defaults.aliases,{decimal:{mask:"~",placeholder:"",repeat:"*",greedy:!1,numericInput:!1,isNumeric:!0,digits:"*",groupSeparator:"",radixPoint:".",groupSize:3,autoGroup:!1,allowPlus:!0,allowMinus:!0,integerDigits:"*",defaultValue:"",prefix:"",suffix:"",getMaskLength:function(t,n,r,i,s){var o=t.length;n||(r=="*"?o=i.length+1:r>1&&(o+=t.length*(r-1)));var u=e.inputmask.escapeRegex.call(this,s.groupSeparator),a=e.inputmask.escapeRegex.call(this,s.radixPoint),f=i.join(""),l=f.replace(new RegExp(u,"g"),"").replace(new RegExp(a),""),c=f.length-l.length;return o+c},postFormat:function(t,n,r,i){if(i.groupSeparator=="")return n;var s=t.slice(),o=e.inArray(i.radixPoint,t);r||s.splice(n,0,"?");var u=s.join("");if(i.autoGroup||r&&u.indexOf(i.groupSeparator)!=-1){var a=e.inputmask.escapeRegex.call(this,i.groupSeparator);u=u.replace(new RegExp(a,"g"),"");var f=u.split(i.radixPoint);u=f[0];var l=new RegExp("([-+]?[\\d?]+)([\\d?]{"+i.groupSize+"})");while(l.test(u))u=u.replace(l,"$1"+i.groupSeparator+"$2"),u=u.replace(i.groupSeparator+i.groupSeparator,i.groupSeparator);f.length>1&&(u+=i.radixPoint+f[1])}t.length=u.length;for(var c=0,h=u.length;c<h;c++)t[c]=u.charAt(c);var p=e.inArray("?",t);return r||t.splice(p,1),r?n:p},regex:{number:function(t){var n=e.inputmask.escapeRegex.call(this,t.groupSeparator),r=e.inputmask.escapeRegex.call(this,t.radixPoint),i=isNaN(t.digits)?t.digits:"{0,"+t.digits+"}",s=t.allowPlus||t.allowMinus?"["+(t.allowPlus?"+":"")+(t.allowMinus?"-":"")+"]?":"";return new RegExp("^"+s+"(\\d+|\\d{1,"+t.groupSize+"}(("+n+"\\d{"+t.groupSize+"})?)+)("+r+"\\d"+i+")?$")}},onKeyDown:function(t,n,r){var i=e(this),s=this;if(t.keyCode==r.keyCode.TAB){var o=e.inArray(r.radixPoint,n);if(o!=-1){var u=i.data("_inputmask").masksets,a=i.data("_inputmask").activeMasksetIndex;for(var f=1;f<=r.digits&&f<r.getMaskLength(u[a]._buffer,u[a].greedy,u[a].repeat,n,r);f++)if(n[o+f]==undefined||n[o+f]=="")n[o+f]="0";s._valueSet(n.join(""))}}else if(t.keyCode==r.keyCode.DELETE||t.keyCode==r.keyCode.BACKSPACE)return r.postFormat(n,0,!0,r),s._valueSet(n.join("")),!0},definitions:{"~":{validator:function(t,n,r,i,s){if(t=="")return!1;if(!i&&r<=1&&n[0]==="0"&&(new RegExp("[\\d-]")).test(t)&&n.join("").length==1)return n[0]="",{pos:0};var o=i?n.slice(0,r):n.slice();o.splice(r,0,t);var u=o.join(""),a=e.inputmask.escapeRegex.call(this,s.groupSeparator);u=u.replace(new RegExp(a,"g"),"");var f=s.regex.number(s).test(u);if(!f){u+="0",f=s.regex.number(s).test(u);if(!f){var l=u.lastIndexOf(s.groupSeparator);for(var c=u.length-l;c<=3;c++)u+="0";f=s.regex.number(s).test(u);if(!f&&!i&&t==s.radixPoint){f=s.regex.number(s).test("0"+u+"0");if(f)return n[r]="0",r++,{pos:r}}}}if(f!=0&&!i&&t!=s.radixPoint){var h=s.postFormat(n,r,!1,s);return{pos:h}}return f},cardinality:1,prevalidator:null}},insertMode:!0,autoUnmask:!1},integer:{regex:{number:function(t){var n=e.inputmask.escapeRegex.call(this,t.groupSeparator),r=t.allowPlus||t.allowMinus?"["+(t.allowPlus?"+":"")+(t.allowMinus?"-":"")+"]?":"";return new RegExp("^"+r+"(\\d+|\\d{1,"+t.groupSize+"}(("+n+"\\d{"+t.groupSize+"})?)+)$")}},alias:"decimal"}})})(jQuery);