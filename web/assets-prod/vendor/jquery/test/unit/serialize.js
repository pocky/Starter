module("serialize",{teardown:moduleTeardown}),test("jQuery.param()",function(){expect(22);var e,t;equal(!jQuery.ajaxSettings||!jQuery.ajaxSettings.traditional,!0,"traditional flag, falsy by default"),e={foo:"bar",baz:42,quux:"All your base are belong to us"},equal(jQuery.param(e),"foo=bar&baz=42&quux=All+your+base+are+belong+to+us","simple"),e={string:"foo","null":null,"undefined":undefined},equal(jQuery.param(e),"string=foo&null=&undefined=","handle nulls and undefineds properly"),e={someName:[1,2,3],regularThing:"blah"},equal(jQuery.param(e),"someName%5B%5D=1&someName%5B%5D=2&someName%5B%5D=3&regularThing=blah","with array"),e={foo:["a","b","c"]},equal(jQuery.param(e),"foo%5B%5D=a&foo%5B%5D=b&foo%5B%5D=c","with array of strings"),e={foo:["baz",42,"All your base are belong to us"]},equal(jQuery.param(e),"foo%5B%5D=baz&foo%5B%5D=42&foo%5B%5D=All+your+base+are+belong+to+us","more array"),e={foo:{bar:"baz",beep:42,quux:"All your base are belong to us"}},equal(jQuery.param(e),"foo%5Bbar%5D=baz&foo%5Bbeep%5D=42&foo%5Bquux%5D=All+your+base+are+belong+to+us","even more arrays"),e={a:[1,2],b:{c:3,d:[4,5],e:{x:[6],y:7,z:[8,9]},f:!0,g:!1,h:undefined},i:[10,11],j:!0,k:!1,l:[undefined,0],m:"cowboy hat?"},equal(decodeURIComponent(jQuery.param(e)),"a[]=1&a[]=2&b[c]=3&b[d][]=4&b[d][]=5&b[e][x][]=6&b[e][y]=7&b[e][z][]=8&b[e][z][]=9&b[f]=true&b[g]=false&b[h]=&i[]=10&i[]=11&j=true&k=false&l[]=&l[]=0&m=cowboy+hat?","huge structure"),e={a:[0,[1,2],[3,[4,5],[6]],{b:[7,[8,9],[{c:10,d:11}],[[12]],[[[13]]],{e:{f:{g:[14,[15]]}}},16]},17]},equal(decodeURIComponent(jQuery.param(e)),"a[]=0&a[1][]=1&a[1][]=2&a[2][]=3&a[2][1][]=4&a[2][1][]=5&a[2][2][]=6&a[3][b][]=7&a[3][b][1][]=8&a[3][b][1][]=9&a[3][b][2][0][c]=10&a[3][b][2][0][d]=11&a[3][b][3][0][]=12&a[3][b][4][0][0][]=13&a[3][b][5][e][f][g][]=14&a[3][b][5][e][f][g][1][]=15&a[3][b][]=16&a[]=17","nested arrays"),e={a:[1,2],b:{c:3,d:[4,5],e:{x:[6],y:7,z:[8,9]},f:!0,g:!1,h:undefined},i:[10,11],j:!0,k:!1,l:[undefined,0],m:"cowboy hat?"},equal(jQuery.param(e,!0),"a=1&a=2&b=%5Bobject+Object%5D&i=10&i=11&j=true&k=false&l=&l=0&m=cowboy+hat%3F","huge structure, forced traditional"),equal(decodeURIComponent(jQuery.param({a:[1,2,3],"b[]":[4,5,6],"c[d]":[7,8,9],e:{f:[10],g:[11,12],h:13}})),"a[]=1&a[]=2&a[]=3&b[]=4&b[]=5&b[]=6&c[d][]=7&c[d][]=8&c[d][]=9&e[f][]=10&e[g][]=11&e[g][]=12&e[h]=13","Make sure params are not double-encoded."),equal(jQuery.param({jquery:"1.4.2"}),"jquery=1.4.2","Check that object with a jQuery property get serialized correctly"),t={traditional:!0},jQuery.ajaxSettings?jQuery.ajaxSetup(t):jQuery.ajaxSettings=t,e={foo:"bar",baz:42,quux:"All your base are belong to us"},equal(jQuery.param(e),"foo=bar&baz=42&quux=All+your+base+are+belong+to+us","simple"),e={someName:[1,2,3],regularThing:"blah"},equal(jQuery.param(e),"someName=1&someName=2&someName=3&regularThing=blah","with array"),e={foo:["a","b","c"]},equal(jQuery.param(e),"foo=a&foo=b&foo=c","with array of strings"),e={"foo[]":["baz",42,"All your base are belong to us"]},equal(jQuery.param(e),"foo%5B%5D=baz&foo%5B%5D=42&foo%5B%5D=All+your+base+are+belong+to+us","more array"),e={"foo[bar]":"baz","foo[beep]":42,"foo[quux]":"All your base are belong to us"},equal(jQuery.param(e),"foo%5Bbar%5D=baz&foo%5Bbeep%5D=42&foo%5Bquux%5D=All+your+base+are+belong+to+us","even more arrays"),e={a:[1,2],b:{c:3,d:[4,5],e:{x:[6],y:7,z:[8,9]},f:!0,g:!1,h:undefined},i:[10,11],j:!0,k:!1,l:[undefined,0],m:"cowboy hat?"},equal(jQuery.param(e),"a=1&a=2&b=%5Bobject+Object%5D&i=10&i=11&j=true&k=false&l=&l=0&m=cowboy+hat%3F","huge structure"),e={a:[0,[1,2],[3,[4,5],[6]],{b:[7,[8,9],[{c:10,d:11}],[[12]],[[[13]]],{e:{f:{g:[14,[15]]}}},16]},17]},equal(jQuery.param(e),"a=0&a=1%2C2&a=3%2C4%2C5%2C6&a=%5Bobject+Object%5D&a=17","nested arrays (not possible when jQuery.param.traditional == true)"),e={a:[1,2],b:{c:3,d:[4,5],e:{x:[6],y:7,z:[8,9]},f:!0,g:!1,h:undefined},i:[10,11],j:!0,k:!1,l:[undefined,0],m:"cowboy hat?"},equal(decodeURIComponent(jQuery.param(e,!1)),"a[]=1&a[]=2&b[c]=3&b[d][]=4&b[d][]=5&b[e][x][]=6&b[e][y]=7&b[e][z][]=8&b[e][z][]=9&b[f]=true&b[g]=false&b[h]=&i[]=10&i[]=11&j=true&k=false&l[]=&l[]=0&m=cowboy+hat?","huge structure, forced not traditional"),e={param1:null},equal(jQuery.param(e,!1),"param1=","Make sure that null params aren't traversed."),e={test:{length:3,foo:"bar"}},equal(jQuery.param(e,!1),"test%5Blength%5D=3&test%5Bfoo%5D=bar","Sub-object with a length property"),jQuery.ajaxSettings===t?delete jQuery.ajaxSettings:jQuery.ajaxSetup({traditional:!1})}),test("jQuery.param() Constructed prop values",function(){function e(){this.prop="val"}expect(4);var t=String,n=Number,r={test:new t("foo")};equal(jQuery.param(r,!1),"test=foo","Do not mistake new String() for a plain object"),r={test:new n(5)},equal(jQuery.param(r,!1),"test=5","Do not mistake new Number() for a plain object"),r={test:new Date},ok(jQuery.param(r,!1),"(Non empty string returned) Do not mistake new Date() for a plain object"),r={test:new e},equal(jQuery.param(r,!1),jQuery.param({test:{prop:"val"}}),"Allow non-native constructed objects")}),test("serialize()",function(){expect(5),jQuery("#search").after("<input type='email' id='html5email' name='email' value='dave@jquery.com' /><input type='number' id='html5number' name='number' value='43' /><input type='file' name='fileupload' />"),equal(jQuery("#form").serialize(),"action=Test&radio2=on&check=on&hidden=&foo%5Bbar%5D=&name=name&search=search&email=dave%40jquery.com&number=43&select1=&select2=3&select3=1&select3=2&select5=3","Check form serialization as query string"),equal(jQuery("input,select,textarea,button","#form").serialize(),"action=Test&radio2=on&check=on&hidden=&foo%5Bbar%5D=&name=name&search=search&email=dave%40jquery.com&number=43&select1=&select2=3&select3=1&select3=2&select5=3","Check input serialization as query string"),equal(jQuery("#testForm").serialize(),"T3=%3F%0D%0AZ&H1=x&H2=&PWD=&T1=&T2=YES&My+Name=me&S1=abc&S3=YES&S4=","Check form serialization as query string"),equal(jQuery("input,select,textarea,button","#testForm").serialize(),"T3=%3F%0D%0AZ&H1=x&H2=&PWD=&T1=&T2=YES&My+Name=me&S1=abc&S3=YES&S4=","Check input serialization as query string"),equal(jQuery("#form, #testForm").serialize(),"action=Test&radio2=on&check=on&hidden=&foo%5Bbar%5D=&name=name&search=search&email=dave%40jquery.com&number=43&select1=&select2=3&select3=1&select3=2&select5=3&T3=%3F%0D%0AZ&H1=x&H2=&PWD=&T1=&T2=YES&My+Name=me&S1=abc&S3=YES&S4=","Multiple form serialization as query string"),jQuery("#html5email, #html5number").remove()});