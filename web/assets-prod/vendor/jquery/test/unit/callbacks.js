module("callbacks",{teardown:moduleTeardown}),function(){function u(e){if(typeof e=="string")return"'"+e+"'";var t=[],n;for(n in e)t.push("'"+n+"': "+e[n]);return"{ "+t.join(", ")+" }"}var e,t=function(t){return function(){e+=t}},n=t("A"),r=t("B"),i=t("C"),s={"":"XABC   X     XABCABCC  X  XBB X   XABA  X   XX",once:"XABC   X     X         X  X   X   XABA  X   XX",memory:"XABC   XABC  XABCABCCC XA XBB XB  XABA  XC  XX",unique:"XABC   X     XABCA     X  XBB X   XAB   X   X",stopOnFalse:"XABC   X     XABCABCC  X  XBB X   XA    X   XX","once memory":"XABC   XABC  X         XA X   XA  XABA  XC  XX","once unique":"XABC   X     X         X  X   X   XAB   X   X","once stopOnFalse":"XABC   X     X         X  X   X   XA    X   XX","memory unique":"XABC   XA    XABCA     XA XBB XB  XAB   XC  X","memory stopOnFalse":"XABC   XABC  XABCABCCC XA XBB XB  XA    X   XX","unique stopOnFalse":"XABC   X     XABCA     X  XBB X   XA    X   X"},o={"no filter":undefined,filter:function(e){return function(){return e.apply(this,arguments)}}};jQuery.each(s,function(t,s){var a={};jQuery.each(t.split(" "),function(){this.length&&(a[this]=!0)}),jQuery.each(o,function(o){jQuery.each({string:t,object:a},function(t,a){test("jQuery.Callbacks( "+u(a)+" ) - "+o,function(){function u(){e+="X"}expect(21),stop(),setTimeout(start,0);var t,o=s.split(/\s+/);e="X",t=jQuery.Callbacks(a),t.add(function(t){e+=t}),t.fire("A"),strictEqual(e,"XA","Basic binding and firing"),strictEqual(t.fired(),!0,".fired() detects firing"),e="X",t.disable(),t.add(function(t){e+=t}),strictEqual(e,"X","Adding a callback after disabling"),t.fire("A"),strictEqual(e,"X","Firing after disabling"),t=jQuery.Callbacks(a),t.add(t.empty),t.add(function(){ok(!1,"not emptied")}),t.fire(),t=jQuery.Callbacks(a),t.add(t.disable),t.add(function(){ok(!1,"not disabled")}),t.fire(),e="X",t=jQuery.Callbacks(a),t.add(function(){equal(this,window,"Basic binding and firing (context)"),e+=Array.prototype.join.call(arguments,"")}),t.fireWith(window,["A","B"]),strictEqual(e,"XAB","Basic binding and firing (arguments)"),e="",t=jQuery.Callbacks(a),t.add(function(){equal(this,window,"fireWith with no arguments (context is window)"),strictEqual(arguments.length,0,"fireWith with no arguments (no arguments)")}),t.fireWith(),e="X",t=jQuery.Callbacks(a),t.add(n,r,i),t.remove(r,i),t.fire(),strictEqual(e,"XA","Basic binding, removing and firing"),e="X",t=jQuery.Callbacks(a),t.add(n),t.add(r),t.add(i),t.empty(),t.fire(),strictEqual(e,"X","Empty"),e="X",t=jQuery.Callbacks(a),t.add(function(t){e+=t}),t.lock(),t.add(function(t){e+=t}),t.fire("A"),t.add(function(t){e+=t}),strictEqual(e,"X","Lock early"),e="X",t=jQuery.Callbacks(a),t.add(function(){t.add(i),n()},r),t.fire(),strictEqual(e,o.shift(),"Proper ordering"),e="X",t.add(function(){t.add(i),n()},r),strictEqual(e,o.shift(),"Add after fire"),e="X",t.fire(),strictEqual(e,o.shift(),"Fire again"),e="X",t=jQuery.Callbacks(a),t.add(function(t){e+=t}),t.fire("A"),strictEqual(e,"XA","Multiple fire (first fire)"),e="X",t.add(function(t){e+=t}),strictEqual(e,o.shift(),"Multiple fire (first new callback)"),e="X",t.fire("B"),strictEqual(e,o.shift(),"Multiple fire (second fire)"),e="X",t.add(function(t){e+=t}),strictEqual(e,o.shift(),"Multiple fire (second new callback)"),e="X",t=jQuery.Callbacks(a),t.add(n,function(){return!1},r),t.add(n),t.fire(),strictEqual(e,o.shift(),"Callback returning false"),e="X",t.add(i),strictEqual(e,o.shift(),"Adding a callback after one returned false"),e="",u.method=function(){e+="!"},t=jQuery.Callbacks(a),t.add(u),t.add(u),t.fire(),strictEqual(e,o.shift(),"No callback iteration")})})})})}(),test("jQuery.Callbacks( options ) - options are copied",function(){expect(1);var e={unique:!0},t=jQuery.Callbacks(e),n=0,r=function(){ok(!(n++),"called once")};e.unique=!1,t.add(r,r),t.fire()}),test("jQuery.Callbacks.fireWith - arguments are copied",function(){expect(1);var e=jQuery.Callbacks("memory"),t=["hello"];e.fireWith(null,t),t[0]="world",e.add(function(e){strictEqual(e,"hello","arguments are copied internally")})}),test("jQuery.Callbacks.remove - should remove all instances",function(){function t(){ok(!1,"function wasn't removed")}expect(1);var e=jQuery.Callbacks();e.add(t,t,function(){ok(!0,"end of test")}).remove(t).fire()}),test("jQuery.Callbacks.has",function(){function t(){return"A"}function n(){return"B"}function r(){return"C"}expect(13);var e=jQuery.Callbacks();e.add(t,n,r),strictEqual(e.has(),!0,"No arguments to .has() returns whether callback function(s) are attached or not"),strictEqual(e.has(t),!0,"Check if a specific callback function is in the Callbacks list"),e.remove(n),strictEqual(e.has(n),!1,"Remove a specific callback function and make sure its no longer there"),strictEqual(e.has(t),!0,"Remove a specific callback function and make sure other callback function is still there"),e.empty(),strictEqual(e.has(),!1,"Empty list and make sure there are no callback function(s)"),strictEqual(e.has(t),!1,"Check for a specific function in an empty() list"),e.add(t,n,function(){strictEqual(e.has(),!0,"Check if list has callback function(s) from within a callback function"),strictEqual(e.has(t),!0,"Check if list has a specific callback from within a callback function")}).fire(),strictEqual(e.has(),!0,"Callbacks list has callback function(s) after firing"),e.disable(),strictEqual(e.has(),!1,"disabled() list has no callback functions (returns false)"),strictEqual(e.has(t),!1,"Check for a specific function in a disabled() list"),e=jQuery.Callbacks("unique"),e.add(t),e.add(t),strictEqual(e.has(),!0,"Check if unique list has callback function(s) attached"),e.lock(),strictEqual(e.has(),!1,"locked() list is empty and returns false")}),test("jQuery.Callbacks() - adding a string doesn't cause a stack overflow",function(){expect(1),jQuery.Callbacks().add("hello world"),ok(!0,"no stack overflow")});