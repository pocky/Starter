module.exports=function(e){var t=["dist/jquery.js","dist/jquery.min.map","dist/jquery.min.js"],n=require("gzip-js"),r=function(t){var n={};try{n=e.file.readJSON(t)}catch(r){}return n},i=r("src/.jshintrc");delete i.onevar,e.initConfig({pkg:e.file.readJSON("package.json"),dst:r("dist/.destination.json"),compare_size:{files:["dist/jquery.js","dist/jquery.min.js"],options:{compress:{gz:function(e){return n.zip(e,{}).length}},cache:"dist/.sizecache.json"}},selector:{destFile:"src/selector-sizzle.js",apiFile:"src/sizzle-jquery.js",srcFile:"src/sizzle/dist/sizzle.js"},build:{all:{dest:"dist/jquery.js",src:["src/intro.js","src/core.js",{flag:"sizzle",src:"src/selector-sizzle.js",alt:"src/selector-native.js"},"src/callbacks.js","src/deferred.js","src/support.js","src/data.js","src/queue.js","src/attributes.js","src/event.js","src/traversing.js","src/manipulation.js",{flag:"wrap",src:"src/wrap.js"},{flag:"css",src:"src/css.js"},"src/serialize.js",{flag:"event-alias",src:"src/event-alias.js"},{flag:"ajax",src:"src/ajax.js"},{flag:"ajax/script",src:"src/ajax/script.js",needs:["ajax"]},{flag:"ajax/jsonp",src:"src/ajax/jsonp.js",needs:["ajax","ajax/script"]},{flag:"ajax/xhr",src:"src/ajax/xhr.js",needs:["ajax"]},{flag:"effects",src:"src/effects.js",needs:["css"]},{flag:"offset",src:"src/offset.js",needs:["css"]},{flag:"dimensions",src:"src/dimensions.js",needs:["css"]},{flag:"deprecated",src:"src/deprecated.js"},"src/exports.js","src/outro.js"]}},jshint:{dist:{src:["dist/jquery.js"],options:i},grunt:{src:["Gruntfile.js"],options:{jshintrc:".jshintrc"}},tests:{src:["test/data/{test,testinit,testrunner}.js","test/unit/**/*.js"],options:{jshintrc:"test/.jshintrc"}}},testswarm:{tests:"ajax attributes callbacks core css data deferred dimensions effects event manipulation offset queue selector serialize support traversing Sizzle".split(" ")},watch:{files:["<%= jshint.grunt.src %>","<%= jshint.tests.src %>","src/**/*.js"],tasks:"dev"},"pre-uglify":{all:{files:{"dist/jquery.pre-min.js":["dist/jquery.js"]},options:{banner:"\n\n\n\n\n\n\n\n\n\n/*! jQuery v<%= pkg.version %> | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license\n//@ sourceMappingURL=jquery.min.map\n*/\n"}}},uglify:{all:{files:{"dist/jquery.min.js":["dist/jquery.pre-min.js"]},options:{preserveComments:"some",sourceMap:"dist/jquery.min.map",sourceMappingURL:"jquery.min.map",report:"min",beautify:{ascii_only:!0},compress:{hoist_funs:!1,join_vars:!1,loops:!1,unused:!1},mangle:{except:["undefined"]}}}},"post-uglify":{all:{files:{"dist/jquery.min.map.tmp":["dist/jquery.min.map"],"dist/jquery.min.js.tmp":["dist/jquery.min.js"]},options:{tempFiles:["dist/jquery.min.map.tmp","dist/jquery.min.js.tmp","dist/jquery.pre-min.js"]}}}}),e.registerTask("testswarm",function(t,n){var r,i=require("testswarm"),s=[],o=/PR-(\d+)/.exec(t),u=e.file.readJSON(n).jquery,a=e.config([this.name,"tests"]);o?r="jQuery pull <a href='https://github.com/jquery/jquery/pull/"+o[1]+"'>#"+o[1]+"</a>":r="jQuery commit #<a href='https://github.com/jquery/jquery/commit/"+t+"'>"+t.substr(0,10)+"</a>",a.forEach(function(e){s.push(u.testUrl+t+"/test/index.html?module="+e)}),i({url:u.swarmUrl,pollInterval:1e4,timeout:18e5,done:this.async()},{authUsername:u.authUsername,authToken:u.authToken,jobName:r,runMax:u.runMax,"runNames[]":a,"runUrls[]":s,"browserSets[]":"popular-no-old-ie"})}),e.registerTask("selector","Build Sizzle-based selector module",function(){var t=e.config("selector"),n=t.destFile,r={api:e.file.read(t.apiFile),src:e.file.read(t.srcFile)},i,s;s=r.src.split("// EXPOSE"),s[1]=r.api,i=s.join(""),e.verbose.writeln("Injected "+t.apiFile+" into "+t.srcFile),e.file.write(n,i.replace(/\x0d\x0a/g,"\n"));if(this.errorCount)return!1;e.log.writeln("File '"+n+"' created.")}),e.registerTask("custom",function(){var t=this.async(),n=[].slice.call(arguments),r=n.length?n[0].replace(/,/g,":"):"";e.log.writeln("Creating custom build...\n"),e.util.spawn({grunt:!0,args:["build:*:*:"+r,"pre-uglify","uglify","dist"]},function(n,r){if(n){e.verbose.error(),t(n);return}e.log.writeln(r.stdout.replace("Done, without errors.","")),t()})}),e.registerMultiTask("build","Concatenate source (include/exclude modules with +/- flags), embed date/version",function(){var t="",n=this.flags,r=!n["*"],i=r||Object.keys(n).length>1,s=this.data.dest,o=this.data.src,u={},a={},f=e.config("pkg.version"),l=function(e,t){r&&!n[e]&&!n["+"+e]&&(a[e]=!1),a[t]||n["-"+e]?a[e]=!0:a[t]===!1&&(n[e]||n["+"+e])&&(delete a[t],u[t]&&u[t].forEach(function(e){n[t]=!0,l(t,e)}))};process.env.COMMIT&&(f+=" "+process.env.COMMIT),o.forEach(function(e){var t=e.flag;t&&(l(t),e.needs&&(u[t]=e.needs,e.needs.forEach(function(e){l(t,e)})))}),Object.keys(a).length&&(f+=" -"+Object.keys(a).join(",-"),e.config.set("pkg.version",f)),o.forEach(function(r){var s=r.flag,o=!1,u=!1,f=[];s&&(a[s]!==undefined&&(f.push([("Excluding "+s).red,("("+r.src+")").grey]),o=!0,u=!r.alt,u||(s+=" alternate",r.src=r.alt)),a[s]===undefined&&(f.push([("Including "+s).green,("("+r.src+")").grey]),n["+"+s]&&(o=!0)),r=r.src,i&&o&&f.forEach(function(t){e.log.writetableln([27,30],t)})),u||(t+=e.file.read(r))}),t=t.replace(/@VERSION/g,f).replace(/@DATE/g,(new Date).toISOString().replace(/:\d+\.\d+Z$/,"Z")),e.file.write(s,t);if(this.errorCount)return!1;e.log.writeln("File '"+s+"' created.")}),e.registerTask("dist",function(){var n,r,i,s,o;return n=Object.keys(e.config("dst")),r=Object.keys(this.flags),i=[].concat(n,r).filter(function(e){return e!=="*"}),s=require("fs"),o=!1,t.forEach(function(t){var n,r,u=s.readFileSync(t,"utf8");/\x0d\x0a/.test(u)&&(e.log.writeln(t+": Incorrect line endings (\\r\\n)"),o=!0);if(u.length!==Buffer.byteLength(u,"utf8")){e.log.writeln(t+": Non-ASCII characters detected:");for(n=0;n<u.length;n++){r=u.charCodeAt(n);if(r>127){e.log.writeln("- position "+n+": "+r),e.log.writeln("-- "+u.substring(n-20,n+20));break}}o=!0}/\.map$/.test(t)?(u=u.replace(/"dist\//g,'"'),s.writeFileSync(t,u,"utf-8")):/\.min\.js$/.test(t)&&(n=0,u=u.replace(/(?:\/\*|)\n?\/\/@\s*sourceMappingURL=.*(\n\*\/|)/g,function(e){return n++?"":e}),s.writeFileSync(t,u,"utf-8")),i.forEach(function(n){var r;/\/$/.test(n)||(n+="/"),r=n+t.replace("dist/",""),e.file.write(r,u),e.log.writeln("File '"+r+"' created.")})}),!o}),e.registerMultiTask("pre-uglify",function(){var t=this.options().banner;this.files.forEach(function(n){var r=n.src.map(function(t){var n=e.file.read(t);return n.replace(/^\/\*!(?:.|\n)*?\*\/\n?/g,"").replace(/^\/\*!(?:.|\n)*?\*\/\n?/gm,function(e){return e.replace(/[^\n]/gm,"")})}).join("\n");e.file.write(n.dest,(t||"")+r)})}),e.registerMultiTask("post-uglify",function(){var t=require("fs");this.files.forEach(function(n){var r=n.src[0];t.renameSync(r,n.dest),e.file.write(r,e.file.read(n.dest).replace(/"dist\//g,'"').replace(/\.pre-min\./g,".").replace(/\/\/@ sourceMappingURL=jquery\.min\.map$/g,""))}),this.options().tempFiles.forEach(function(e){t.unlink(e)})}),e.loadNpmTasks("grunt-compare-size"),e.loadNpmTasks("grunt-git-authors"),e.loadNpmTasks("grunt-update-submodules"),e.loadNpmTasks("grunt-contrib-watch"),e.loadNpmTasks("grunt-contrib-jshint"),e.loadNpmTasks("grunt-contrib-uglify"),e.registerTask("default",["update_submodules","selector","build:*:*","jshint","pre-uglify","uglify","post-uglify","dist:*","compare_size"]),e.registerTask("dev",["selector","build:*:*","jshint"])};